{% extends "intranet/layout.html" %}

{% set title = "Edit post" %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
{% endblock %}
{% block body %}
<section class="boxed constrain-width">
  <h2>Edit post</h2>
  <form class="edit-post" method="POST" enctype="multipart/form-data">
    {{ form.csrf_token }}
    <div class="field">
      {{ form.title.label }}
      {{ form.title }}
    </div>
    <div class="field">
      {{ form.content }}
    </div>
    <div class="field">
      {{ form.upload }}
    </div>
    <div class="field">
      {{ form.published }}
      {{ form.published.label }}
    </div>
    <div class="field">
      <input type=submit value="Submit">
    </div>
  </form>
  {% if post %}
  <p>
    <a id="remove" href="/intranet/remove-post/{{ post.id }}/{{ post.slug }}/">Remove</a>
  </p>
  {% endif %}
</section>

{% if post %}
<script>
document.getElementById("remove").addEventListener("click", function (event) {
  if (!confirm('This will delete post "{{ post.title }}"\nAre you sure you want to do that?')) {
    event.preventDefault();
  }
}, false)
</script>
<script>
var simplemde = new SimpleMDE({
  element: document.getElementById("content"),
  spellChecker: false,
});
</script>
{% endif %}
{% endblock %}
